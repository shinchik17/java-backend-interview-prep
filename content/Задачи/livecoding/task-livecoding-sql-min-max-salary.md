#### 6. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–ø–∏—Å–∞—Ç—å sql –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤–µ—Ä–Ω–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –∑–∞—Ä–ø–ª–∞—Ç—É –ø–æ –≤—Å–µ–º –æ—Ç–¥–µ–ª–∞–º —Å—Ä–µ–¥–∏ –Ω–µ —É–≤–æ–ª–µ–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤

```
–í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –µ—Å—Ç—å –¥–≤–µ —Ç–∞–±–ª–∏—Ü—ã: ""units"" - –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∫–æ–º–ø–∞–Ω–∏–∏ –∏ ""employees"" - —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –∫–æ–º–ø–∞–Ω–∏–∏
units:
id int // Primary Key
name text // (–Ω–∞–∑–≤–∞–Ω–∏–µ unit)
employees:
id int // Primary Key
unit_id int // Foreign Key -> units::id
salary numeric // (–∑–∞—Ä–ø–ª–∞—Ç–∞)
fired boolean // (—Ñ–ª–∞–≥ —É–≤–æ–ª–µ–Ω)

```

{{< hint warning >}}
**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é** ¬†
{{< /hint >}}

{{< details "–ü–æ–¥—Å–∫–∞–∑–∫–∏" close >}}
üîó –ù—É–∂–Ω–æ **–æ–±—ä–µ–¥–∏–Ω–∏—Ç—å** —Ç–∞–±–ª–∏—Ü—ã `units` –∏ `employees` –ø–æ `unit_id`.  
‚ö° –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å **–Ω–µ —É–≤–æ–ª–µ–Ω–Ω—ã—Ö** —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (`fired = FALSE`).  
üìä –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **`GROUP BY`**, —á—Ç–æ–±—ã –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å –∑–∞—Ä–ø–ª–∞—Ç—ã –ø–æ –æ—Ç–¥–µ–ª–∞–º.  
üìà **`MIN()` –∏ `MAX()`** –ø–æ–º–æ–≥—É—Ç –Ω–∞–π—Ç–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –∑–∞—Ä–ø–ª–∞—Ç—É.
{{< /details >}}

{{< details "–†–µ—à–µ–Ω–∏–µ" close >}}

```sql
SELECT 
    u.id AS unit_id,
    u.name AS unit_name,
    MIN(e.salary) AS min_salary,
    MAX(e.salary) AS max_salary
FROM units u
JOIN employees e ON u.id = e.unit_id
WHERE e.fired = FALSE
GROUP BY u.id, u.name;
```

üìå **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**

- **`JOIN employees e ON u.id = e.unit_id`** ‚Äì —Å–≤—è–∑—ã–≤–∞–µ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å –∏—Ö –æ—Ç–¥–µ–ª–∞–º–∏.
- **`WHERE e.fired = FALSE`** ‚Äì –∏—Å–∫–ª—é—á–∞–µ–º —É–≤–æ–ª–µ–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.
- **`MIN(e.salary)` –∏ `MAX(e.salary)`** ‚Äì –≤—ã—á–∏—Å–ª—è–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –∑–∞—Ä–ø–ª–∞—Ç—ã.
- **`GROUP BY u.id, u.name`** ‚Äì –≥—Ä—É–ø–ø–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –æ—Ç–¥–µ–ª–∞–º.

üî• **–í—ã–≤–æ–¥ –ø—Ä–∏–º–µ—Ä–∞:**

|unit_id|unit_name|min_salary|max_salary|
|---|---|---|---|
|1|IT|50000|150000|
|2|HR|40000|90000|

‚úÖ **–ì–æ—Ç–æ–≤–æ!** üöÄ
{{< /details >}}

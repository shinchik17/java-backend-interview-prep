#### 14. –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —É –∫–æ—Ç–æ—Ä—ã—Ö –±–æ–ª—å—à–µ –æ–¥–Ω–æ–π –º–∞—à–∏–Ω—ã

**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  
üöó **–í—ã–≤–µ—Å—Ç–∏ –∏–º–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —É –∫–æ—Ç–æ—Ä—ã—Ö –±–æ–ª–µ–µ –æ–¥–Ω–æ–≥–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—è.**

```sql
-- –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É USER
CREATE TABLE USER (
    id INT PRIMARY KEY,
    name VARCHAR(50) NOT NULL
);

-- –í—Å—Ç–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü—É USER
INSERT INTO USER (id, name) VALUES
(1, 'Ivan'),
(2, 'Oleg'),
(3, 'Anna'),
(4, 'Ivan'),
(5, 'Ted');

-- –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É CAR
CREATE TABLE CAR (
    id INT PRIMARY KEY,
    model VARCHAR(50) NOT NULL,
    user_id INT NOT NULL,
    FOREIGN KEY (user_id) REFERENCES USER(id)
);

-- –í—Å—Ç–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü—É CAR
INSERT INTO CAR (id, model, user_id) VALUES
(4422, 'Opel 1', 1),
(4523, 'BMV 5', 2),
(4612, 'VW', 3),
(4853, 'BMV 6', 4);
```



{{< hint warning >}}
**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é** ¬†
{{< /hint >}}

{{< details "–ü–æ–¥—Å–∫–∞–∑–∫–∏" close >}}
üí° –ù–∞–º –Ω—É–∂–Ω–æ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ `user_id`.  
üí° –ò—Å–ø–æ–ª—å–∑—É–µ–º `HAVING` –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —É –∫–æ—Ç–æ—Ä—ã—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π (`COUNT(user_id)`) –±–æ–ª—å—à–µ 1.  
üí° –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ–º —Ç–∞–±–ª–∏—Ü—É `USER`, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∏–º–µ–Ω–∞.
{{< /details >}}

{{< details "–†–µ—à–µ–Ω–∏–µ" close >}}

```sql
SELECT u.name 
FROM USER u
JOIN CAR c ON u.id = c.user_id
GROUP BY u.id, u.name
HAVING COUNT(c.id) > 1;
```

‚úÖ **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è:**

- –ò—Å–ø–æ–ª—å–∑—É–µ–º `JOIN`, —á—Ç–æ–±—ã —Å–æ–µ–¥–∏–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∏—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª–∏.
- –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ `user_id`, —Ç–∞–∫ –∫–∞–∫ –Ω–∞–º –Ω—É–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—à–∏–Ω —É –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- `HAVING COUNT(c.id) > 1` —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–µ—Ö, —É –∫–æ–≥–æ –º–∞—à–∏–Ω –±–æ–ª—å—à–µ –æ–¥–Ω–æ–π.

üî• –¢–µ–ø–µ—Ä—å –∑–∞–ø—Ä–æ—Å –≤–µ—Ä–Ω–µ—Ç —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —É –∫–æ—Ç–æ—Ä—ã—Ö –±–æ–ª—å—à–µ –æ–¥–Ω–æ–≥–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—è! üöÄ
{{< /details >}}
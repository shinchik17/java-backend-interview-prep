#### 8. –ü–æ–ª—É—á–∏—Ç—å id –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø–æ—Ç—Ä–∞—Ç–∏–≤—à–∏—Ö –±–æ–ª–µ–µ 1 000 000 —Ä—É–±–ª–µ–π (–±–µ–∑ –ø–æ–¥–∑–∞–ø—Ä–æ—Å–æ–≤)?

```
–ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å —Å–≤–æ–π –º–∞–≥–∞–∑–∏–Ω. –ö –Ω–∞–º –ø—Ä–∏—Ö–æ–¥—è—Ç –ª—é–¥–∏ –∏ –ø–æ–∫—É–ø–∞—é—Ç —É –Ω–∞—Å —á—Ç–æ-—Ç–æ. –ú—ã —Ö—Ä–∞–Ω–∏–º –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é –ø–æ–∫—É–ø–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ç–∞–±–ª–∏—Ü–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –¢–∞–±–ª–∏—Ü–∞ –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:
orders:
id - –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω—ã–π –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á,
user_id - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
amount - —Å—É–º–º–∞ –ø–æ–∫—É–ø–∫–∏ –∫–æ—Ç–æ—Ä—É—é —Å–æ–≤–µ—Ä—à–∏–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

–ú—ã –æ–ø–µ—Ä–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ —ç—Ç–æ–π –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ–π –∏ —Å—á–∏—Ç–∞–µ–º, —á—Ç–æ –¥—Ä—É–≥–∏—Ö —Ç–∞–±–ª–∏—Ü –Ω–µ—Ç. –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–ø–∏—Å–∞—Ç—å SQL –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–≤–µ—Ä—à–∏–ª–∏ –ø–æ–∫—É–ø–∫–∏ –∑–∞ –≤—Å–µ –≤—Ä–µ–º—è –Ω–∞ —Å—É–º–º—É –±–æ–ª—å—à–µ —á–µ–º –Ω–∞ 1 000 000 —Ä—É–±–ª–µ–π.
–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: –ó–∞–ø—Ä–æ—Å –Ω–∞–¥–æ –Ω–∞–ø–∏—Å–∞—Ç—å –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–æ–¥–∑–∞–ø—Ä–æ—Å–æ–≤.

```

{{< hint warning >}}
**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é** ¬†
{{< /hint >}}

{{< details "–ü–æ–¥—Å–∫–∞–∑–∫–∏" close >}}
üìä –ù—É–∂–Ω–æ –Ω–∞–π—Ç–∏ **–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**, —á—å—è –æ–±—â–∞—è —Å—É–º–º–∞ –ø–æ–∫—É–ø–æ–∫ **–±–æ–ª—å—à–µ 1 000 000**.  
üîó –¢–∞–±–ª–∏—Ü–∞ `orders` —Å–æ–¥–µ—Ä–∂–∏—Ç **user_id** –∏ **amount** (—Å—É–º–º–∞ –ø–æ–∫—É–ø–∫–∏).  
üßÆ –ù–∞–º –Ω—É–∂–Ω–æ **—Å—É–º–º–∏—Ä–æ–≤–∞—Ç—å** `amount` –ø–æ –∫–∞–∂–¥–æ–º—É `user_id`.  
üöÄ –ò—Å–ø–æ–ª—å–∑—É–µ–º **`GROUP BY`** –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –∏ **`HAVING`** –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.
{{< /details >}}

{{< details "–†–µ—à–µ–Ω–∏–µ" close >}}

```sql
SELECT user_id 
FROM orders
GROUP BY user_id
HAVING SUM(amount) > 1000000;
```

üìå **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**

- **`GROUP BY user_id`** ‚Äì –≥—Ä—É–ø–ø–∏—Ä—É–µ–º –∑–∞–∫–∞–∑—ã –ø–æ `user_id`.
- **`SUM(amount)`** ‚Äì —Å—á–∏—Ç–∞–µ–º –æ–±—â—É—é —Å—É–º–º—É –ø–æ–∫—É–ø–æ–∫ –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- **`HAVING SUM(amount) > 1000000`** ‚Äì –æ—Ç–±–∏—Ä–∞–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ—Ö, –∫—Ç–æ **–ø–æ—Ç—Ä–∞—Ç–∏–ª –±–æ–ª—å—à–µ –º–∏–ª–ª–∏–æ–Ω–∞**.

‚úÖ **–ì–æ—Ç–æ–≤–æ!** üõçüî•
{{< /details >}}
